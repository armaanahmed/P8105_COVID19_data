<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Access to Mental Health</title>

<script src="site_libs/header-attrs-2.11/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/spacelab.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.10.0/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<link href="site_libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="site_libs/plotly-main-2.5.1/plotly-latest.min.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>








<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Home</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="about.html">About Us</a>
</li>
<li>
  <a href="analysis_2.html">Data Exploration</a>
</li>
<li>
  <a href="dashboard.html">Dashboard</a>
</li>
<li>
  <a href="mental_health.html">Mental Healthcare and the Pandemic</a>
</li>
<li>
  <a href="mailto:&lt;br2598@cumc.columbia.edu&gt;">
    <span class="fa fa-envelope fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="http://github.com/brojasnyc/">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Access to Mental Health</h1>

</div>


<div id="mental-healthcare-and-the-pandemic" class="section level2">
<h2>Mental Healthcare and the Pandemic</h2>
<p>Let’s use plotly to illustrate the following:</p>
<p>The proportion of Americans who were not able to get access to mental health care when they needed it, by age (4x4 facet by age) The proportion of Americans who used pharmaceuticals for their mental health, by age (4x4 facet by age)</p>
<p>4x4 with CIs or one chart with no CI (adding CI might get messy)</p>
<p>Maybe overlay a second set of axes (x2=x1, y2 = COVID count of deaths by end of week) to compare COVID deaths to the mental health status by age?</p>
<p>COVID mortality from Oct 2020 to Oct 2021</p>
<pre class="r"><code>cm_df = read_csv(&quot;Provisional_COVID-19_Death_Counts_by_Week_Ending_Date_and_State.csv&quot;) %&gt;% 
  janitor::clean_names() %&gt;%
  mutate(
    start_date = as_date(start_date, format = &#39;%m/%d/%Y&#39;), 
    end_date = as_date(end_date, format = &#39;%m/%d/%Y&#39;),
   ) %&gt;%
   filter(end_date &gt;=(&quot;2020-08-31&quot;) &amp; end_date &lt;= (&quot;2021-10-11&quot;)) %&gt;%
  filter(state == &quot;United States&quot;) %&gt;%
  filter(group == &quot;By Week&quot;)</code></pre>
<pre><code>## Rows: 6912 Columns: 17</code></pre>
<pre><code>## -- Column specification --------------------------------------------------------
## Delimiter: &quot;,&quot;
## chr (8): Data as of, Start Date, End Date, Group, Year, Week Ending Date, St...
## dbl (3): Month, MMWR Week, Percent of Expected Deaths</code></pre>
<pre><code>## 
## i Use `spec()` to retrieve the full column specification for this data.
## i Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<pre class="r"><code>cm_anxdep_df = read_csv(&quot;Provisional_COVID-19_Death_Counts_by_Week_Ending_Date_and_State.csv&quot;) %&gt;%  #Anxiety survey began earlier
  janitor::clean_names() %&gt;%
  mutate(
    start_date = as_date(start_date, format = &#39;%m/%d/%Y&#39;), 
    end_date = as_date(end_date, format = &#39;%m/%d/%Y&#39;),
   ) %&gt;%
   filter(end_date &gt;=(&quot;2020-05-05&quot;) &amp; end_date &lt;= (&quot;2021-10-11&quot;)) %&gt;%
  filter(state == &quot;United States&quot;) %&gt;%
  filter(group == &quot;By Week&quot;)</code></pre>
<pre><code>## Rows: 6912 Columns: 17</code></pre>
<pre><code>## -- Column specification --------------------------------------------------------
## Delimiter: &quot;,&quot;
## chr (8): Data as of, Start Date, End Date, Group, Year, Week Ending Date, St...
## dbl (3): Month, MMWR Week, Percent of Expected Deaths</code></pre>
<pre><code>## 
## i Use `spec()` to retrieve the full column specification for this data.
## i Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<pre class="r"><code>z = cm_df %&gt;% 
  ggplot(aes(x = end_date, y = covid_19_deaths)) + 
  geom_line()
ggplotly(z)</code></pre>
<div id="htmlwidget-cf94200eb63e150bdd5d" style="width:90%;height:345.6px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-cf94200eb63e150bdd5d">{"x":{"data":[{"x":[18510,18517,18524,18531,18538,18545,18552,18559,18566,18573,18580,18587,18594,18601,18608,18615,18622,18629,18636,18643,18650,18657,18664,18671,18678,18685,18692,18699,18706,18713,18720,18727,18734,18741,18748,18755,18762,18769,18776,18783,18790,18797,18804,18811,18818,18825,18832,18839,18846,18853,18860,18867,18874,18881,18888,18895,18902,18909],"y":[5018,4625,4276,4300,4242,4818,5199,5996,7025,8760,10651,13359,15623,18564,20923,22327,23379,24869,25986,25705,23677,20312,17028,13519,10813,8640,6717,5711,4887,4441,4181,4295,4434,4578,4158,3980,3671,3226,2764,2341,2033,1769,1625,1533,1637,1974,2754,4091,6427,9293,12059,13992,15235,15101,14926,14010,12385,10829],"text":["end_date: 2020-09-05<br />covid_19_deaths:  5018","end_date: 2020-09-12<br />covid_19_deaths:  4625","end_date: 2020-09-19<br />covid_19_deaths:  4276","end_date: 2020-09-26<br />covid_19_deaths:  4300","end_date: 2020-10-03<br />covid_19_deaths:  4242","end_date: 2020-10-10<br />covid_19_deaths:  4818","end_date: 2020-10-17<br />covid_19_deaths:  5199","end_date: 2020-10-24<br />covid_19_deaths:  5996","end_date: 2020-10-31<br />covid_19_deaths:  7025","end_date: 2020-11-07<br />covid_19_deaths:  8760","end_date: 2020-11-14<br />covid_19_deaths: 10651","end_date: 2020-11-21<br />covid_19_deaths: 13359","end_date: 2020-11-28<br />covid_19_deaths: 15623","end_date: 2020-12-05<br />covid_19_deaths: 18564","end_date: 2020-12-12<br />covid_19_deaths: 20923","end_date: 2020-12-19<br />covid_19_deaths: 22327","end_date: 2020-12-26<br />covid_19_deaths: 23379","end_date: 2021-01-02<br />covid_19_deaths: 24869","end_date: 2021-01-09<br />covid_19_deaths: 25986","end_date: 2021-01-16<br />covid_19_deaths: 25705","end_date: 2021-01-23<br />covid_19_deaths: 23677","end_date: 2021-01-30<br />covid_19_deaths: 20312","end_date: 2021-02-06<br />covid_19_deaths: 17028","end_date: 2021-02-13<br />covid_19_deaths: 13519","end_date: 2021-02-20<br />covid_19_deaths: 10813","end_date: 2021-02-27<br />covid_19_deaths:  8640","end_date: 2021-03-06<br />covid_19_deaths:  6717","end_date: 2021-03-13<br />covid_19_deaths:  5711","end_date: 2021-03-20<br />covid_19_deaths:  4887","end_date: 2021-03-27<br />covid_19_deaths:  4441","end_date: 2021-04-03<br />covid_19_deaths:  4181","end_date: 2021-04-10<br />covid_19_deaths:  4295","end_date: 2021-04-17<br />covid_19_deaths:  4434","end_date: 2021-04-24<br />covid_19_deaths:  4578","end_date: 2021-05-01<br />covid_19_deaths:  4158","end_date: 2021-05-08<br />covid_19_deaths:  3980","end_date: 2021-05-15<br />covid_19_deaths:  3671","end_date: 2021-05-22<br />covid_19_deaths:  3226","end_date: 2021-05-29<br />covid_19_deaths:  2764","end_date: 2021-06-05<br />covid_19_deaths:  2341","end_date: 2021-06-12<br />covid_19_deaths:  2033","end_date: 2021-06-19<br />covid_19_deaths:  1769","end_date: 2021-06-26<br />covid_19_deaths:  1625","end_date: 2021-07-03<br />covid_19_deaths:  1533","end_date: 2021-07-10<br />covid_19_deaths:  1637","end_date: 2021-07-17<br />covid_19_deaths:  1974","end_date: 2021-07-24<br />covid_19_deaths:  2754","end_date: 2021-07-31<br />covid_19_deaths:  4091","end_date: 2021-08-07<br />covid_19_deaths:  6427","end_date: 2021-08-14<br />covid_19_deaths:  9293","end_date: 2021-08-21<br />covid_19_deaths: 12059","end_date: 2021-08-28<br />covid_19_deaths: 13992","end_date: 2021-09-04<br />covid_19_deaths: 15235","end_date: 2021-09-11<br />covid_19_deaths: 15101","end_date: 2021-09-18<br />covid_19_deaths: 14926","end_date: 2021-09-25<br />covid_19_deaths: 14010","end_date: 2021-10-02<br />covid_19_deaths: 12385","end_date: 2021-10-09<br />covid_19_deaths: 10829"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":28.1800844517574,"r":7.30593607305936,"b":42.1344223513008,"l":54.7945205479452},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[18490.05,18928.95],"tickmode":"array","ticktext":["Oct 2020","Jan 2021","Apr 2021","Jul 2021","Oct 2021"],"tickvals":[18536,18628,18718,18809,18901],"categoryorder":"array","categoryarray":["Oct 2020","Jan 2021","Apr 2021","Jul 2021","Oct 2021"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"end_date","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[310.35,27208.65],"tickmode":"array","ticktext":["10000","20000"],"tickvals":[10000,20000],"categoryorder":"array","categoryarray":["10000","20000"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"covid_19_deaths","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"7fa0374166e":{"x":{},"y":{},"type":"scatter"}},"cur_data":"7fa0374166e","visdat":{"7fa0374166e":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>Cleaning Mental Healthcare data, filtering separately by age and state</p>
<pre class="r"><code>mh_care_df = read_csv(&quot;Mental_Health_Care_in_the_Last_4_Weeks.csv&quot;) %&gt;%  
  janitor::clean_names() %&gt;% 
  mutate(
    time_period_start_date = as_date(time_period_start_date, format = &#39;%m/%d/%Y&#39;), 
    time_period_end_date = as_date(time_period_end_date, format = &#39;%m/%d/%Y&#39;),
    state = as_factor(state),
    subgroup = as_factor(subgroup),
    group = as_factor(group),
    indicator = as_factor(indicator)    
   )</code></pre>
<pre><code>## Rows: 8276 Columns: 15</code></pre>
<pre><code>## -- Column specification --------------------------------------------------------
## Delimiter: &quot;,&quot;
## chr (10): Indicator, Group, State, Subgroup, Phase, Time Period Label, Time ...
## dbl  (5): Time Period, Value, LowCI, HighCI, Suppression Flag</code></pre>
<pre><code>## 
## i Use `spec()` to retrieve the full column specification for this data.
## i Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<pre class="r"><code>mh_age = c(&quot;18 - 29 years&quot;, &quot;30 - 39 years&quot;, &quot;40 - 49 years&quot;, &quot;50 - 59 years&quot;, &quot;60 - 69 years&quot;, &quot;70 - 79 years&quot;, &quot;80 years and above&quot;)

mh_age_df = mh_care_df %&gt;% filter(subgroup %in% mh_age) %&gt;% 
  #filter(indicator %in% &quot;Took Prescription Medication for Mental Health And/Or Received Counseling or Therapy, Last 4 Weeks&quot;)
  #filter(indicator %in% &quot;Took Prescription Medication for Mental Health, Last 4 Weeks&quot;)
  filter(indicator %in% &quot;Needed Counseling or Therapy But Did Not Get It, Last 4 Weeks&quot;)
  #filter(indicator %in% &quot;Received Counseling or Therapy, Last 4 Weeks&quot;)

mh_state = c(&quot;By Race/Hispanic ethnicity&quot;, &quot;United States&quot;, &quot;By Disability status&quot;, &quot;By Gender identity&quot;, &quot;By Age&quot;, &quot;By Sex&quot;, &quot;By Education&quot;, &quot;National Estimate&quot;, &quot;By Presence of Symptoms of Anxiety/Depression&quot;, &quot;By Sexual orientation&quot;)

mh_state_df = mh_care_df %&gt;% filter(group %notin% mh_state) %&gt;% 
  #filter(indicator %in% &quot;Took Prescription Medication for Mental Health And/Or Received Counseling or Therapy, Last 4 Weeks&quot;)
  #filter(indicator %in% &quot;Took Prescription Medication for Mental Health, Last 4 Weeks&quot;)
  filter(indicator %in% &quot;Needed Counseling or Therapy But Did Not Get It, Last 4 Weeks&quot;)
  #filter(indicator %in% &quot;Received Counseling or Therapy, Last 4 Weeks&quot;)</code></pre>
<p>Cleaning Anxiety Data</p>
<pre class="r"><code>anxdep_df = read_csv(&quot;Indicators_of_Anxiety_or_Depression_Based_on_Reported_Frequency_of_Symptoms_During_Last_7_Days.csv&quot;) %&gt;%  
  janitor::clean_names() %&gt;% 
  mutate(
    time_period_start_date = as_date(time_period_start_date, format = &#39;%m/%d/%Y&#39;), 
    time_period_end_date = as_date(time_period_end_date, format = &#39;%m/%d/%Y&#39;),
    state = as_factor(state),
    subgroup = as_factor(subgroup),
    group = as_factor(group),
    indicator = as_factor(indicator)
   )</code></pre>
<pre><code>## Rows: 8604 Columns: 14</code></pre>
<pre><code>## -- Column specification --------------------------------------------------------
## Delimiter: &quot;,&quot;
## chr (10): Indicator, Group, State, Subgroup, Phase, Time Period Label, Time ...
## dbl  (4): Time Period, Value, Low CI, High CI</code></pre>
<pre><code>## 
## i Use `spec()` to retrieve the full column specification for this data.
## i Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<pre class="r"><code>anxdep_age = c(&quot;18 - 29 years&quot;, &quot;30 - 39 years&quot;, &quot;40 - 49 years&quot;, &quot;50 - 59 years&quot;, &quot;60 - 69 years&quot;, &quot;70 - 79 years&quot;, &quot;80 years and above&quot;)

anxdep_age_df = anxdep_df %&gt;% filter(subgroup %in% mh_age) %&gt;% 
  #filter(indicator %in% &quot;Symptoms of Anxiety Disorder&quot;)
  filter(indicator %in% &quot;Symptoms of Anxiety Disorder or Depressive Disorder&quot;)
  #filter(indicator %in% &quot;Symptoms of Depressive Disorder&quot;)
  
anxdep_state = c(&quot;By Race/Hispanic ethnicity&quot;, &quot;United States&quot;, &quot;By Disability status&quot;, &quot;By Gender identity&quot;, &quot;By Age&quot;, &quot;By Sex&quot;, &quot;By Education&quot;, &quot;National Estimate&quot;, &quot;By Presence of Symptoms of Anxiety/Depression&quot;, &quot;By Sexual orientation&quot;)

anxdep_state_df = anxdep_df %&gt;% filter(group %notin% anxdep_state) %&gt;% 
  #filter(indicator %in% &quot;Symptoms of Anxiety Disorder&quot;)
  filter(indicator %in% &quot;Symptoms of Anxiety Disorder or Depressive Disorder&quot;)
  #filter(indicator %in% &quot;Symptoms of Depressive Disorder&quot;)</code></pre>
</div>
<div id="plotting-age-vs" class="section level2">
<h2>Plotting Age vs …</h2>
<pre class="r"><code>#Date vs subgroup w/ facet w/ CI
mh_age_df %&gt;%
  ggplot(aes(x = time_period_start_date, y = value, color = subgroup)) + 
  geom_line() + 
  geom_ribbon(aes(ymin=low_ci, ymax=high_ci), linetype=2, alpha=0.1)  + 
  facet_wrap(vars(mh_age_df$subgroup)) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  labs(x = &quot;Month&quot;, y = &quot;% Subgroup affected&quot;)</code></pre>
<p><img src="mental_health_files/figure-html/unnamed-chunk-5-1.png" width="90%" /></p>
<pre class="r"><code>#Date vs subgroup, no facets w/ CI
mh_age_df %&gt;%
  ggplot(aes(x = time_period_start_date, y = value, color = subgroup)) + 
  geom_line() + 
  geom_ribbon(aes(ymin=low_ci, ymax=high_ci), linetype=2, alpha=0.1)  + 
#  facet_wrap(vars(mh_age_df$subgroup)) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  labs(x = &quot;Month&quot;, y = &quot;% Subgroup affected&quot;, title = &quot;Healthcare inaccessibility throughout the pandemic by age group &quot;)</code></pre>
<p><img src="mental_health_files/figure-html/unnamed-chunk-5-2.png" width="90%" /></p>
<pre class="r"><code># mental health availability w/ facet w/o CI w/COVID mort
ggplot() + 
  geom_line(data = mh_age_df, aes(x = time_period_start_date, y = value, color = subgroup) ) +
  geom_line(data = cm_df, aes(x = end_date, y = covid_19_deaths * 0.001) ) + 
  #geom_ribbon(aes(data = mh_age_df, ymin=low_ci, ymax=high_ci), linetype=2, alpha=0.1)  +
  facet_wrap(vars(subgroup)) +
  scale_y_continuous(breaks = seq(0, 40, 5), sec.axis = sec_axis(trans = ~.*001)) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) + 
  labs(x = &quot;Month&quot;, y = &quot;% without access to mental health treatment \n COVID mortality in tens of thousands&quot;,title = &quot;Healthcare inaccessibility throughout the pandemic by age group &quot;)</code></pre>
<p><img src="mental_health_files/figure-html/unnamed-chunk-5-3.png" width="90%" /></p>
<pre class="r"><code>#ggplotly(g)

## % Screened for Anxiety or Depression by age
ggplot() + 
  geom_line(data = anxdep_age_df, aes(x = time_period_start_date, y = value, color = subgroup) ) +
  geom_line(data = cm_anxdep_df, aes(x = end_date, y = covid_19_deaths * 0.001) ) + 
  #geom_ribbon(aes(data = mh_age_df, ymin=low_ci, ymax=high_ci), linetype=2, alpha=0.1)  +
  facet_wrap(vars(subgroup)) +
  scale_y_continuous(breaks = seq(0, 80, 10), sec.axis = sec_axis(trans = ~.*001)) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) + 
  labs(x = &quot;Month&quot;, y = &quot;% Subgroup affected \n COVID mortality in tens of thousands&quot;, title = &quot;% Positive screening for Anxiety or Depression by age&quot;)</code></pre>
<p><img src="mental_health_files/figure-html/unnamed-chunk-5-4.png" width="90%" /></p>
</div>
<div id="hypothesis-test" class="section level2">
<h2>Hypothesis Test</h2>
<p>We will explore whether there may be differences in the proportion of individuals unable to find mental healthcare.</p>
<p>We use one-way ANOVA because we are comparing within a single categorical variable with more than two levels.</p>
<p><span class="math inline">\(H_0\)</span> : There is no difference in accessibility of mental healthcare by states</p>
<p><span class="math inline">\(H_1\)</span> : At least two states have unequal access for healthcare</p>
<pre class="r"><code>state_means = mh_state_df %&gt;% 
  select(subgroup, value)%&gt;%
  group_by(subgroup) %&gt;% 
  na.omit() %&gt;%
  summarize(mean = mean(value),
            se = sd(value)
            )
  knitr::kable(head(state_means,caption = &quot;Average % incidence of anxiety/depression by State during time period&quot;))</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">subgroup</th>
<th align="right">mean</th>
<th align="right">se</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Alabama</td>
<td align="right">11.30741</td>
<td align="right">2.082884</td>
</tr>
<tr class="even">
<td align="left">Alaska</td>
<td align="right">11.28519</td>
<td align="right">1.912852</td>
</tr>
<tr class="odd">
<td align="left">Arizona</td>
<td align="right">11.40741</td>
<td align="right">1.680642</td>
</tr>
<tr class="even">
<td align="left">Arkansas</td>
<td align="right">10.85185</td>
<td align="right">1.720995</td>
</tr>
<tr class="odd">
<td align="left">California</td>
<td align="right">11.56296</td>
<td align="right">1.595703</td>
</tr>
<tr class="even">
<td align="left">Colorado</td>
<td align="right">13.15556</td>
<td align="right">1.713596</td>
</tr>
</tbody>
</table>
<p>Based on the below we conclude with beyond 99.99% confidence that there is unequal access between states and the accessibility of mental healthcare.</p>
<pre class="r"><code>anova_state_mh_access = aov(value ~factor(subgroup), data = mh_state_df)
summary(anova_state_mh_access) </code></pre>
<pre><code>##                    Df Sum Sq Mean Sq F value Pr(&gt;F)    
## factor(subgroup)   50   2599   51.98   14.94 &lt;2e-16 ***
## Residuals        1319   4589    3.48                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 7 observations deleted due to missingness</code></pre>
<p>We do a similar test to see if there are differences between age group and access to care, and reach a similar conclusion:</p>
<pre class="r"><code>anova_age_mh_access = aov(value ~factor(subgroup), data = mh_age_df)
summary(anova_age_mh_access) </code></pre>
<pre><code>##                   Df Sum Sq Mean Sq F value Pr(&gt;F)    
## factor(subgroup)   6   6187  1031.2   777.5 &lt;2e-16 ***
## Residuals        177    235     1.3                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 26 observations deleted due to missingness</code></pre>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
